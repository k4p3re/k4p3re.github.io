---
title: "[ten*2] -  p3rf3ctr00t CTF 2024"
date: 2024-11-23 20:55:00 +03
categories: [Forensics]
tags: [forensic analysis, ftk ]
image: /assets/img/Posts/root.jpg
---

### Introduction
Our first-ever Capture The Flag (CTF) competition was a resounding success! ðŸŽ‰

Designed to challenge participants with real-world cybersecurity scenarios, the event brought together talented individuals eager to test their skills and solve engaging challenges.
Weâ€™re proud of the enthusiasm, creativity, and teamwork displayed by all participants, and we canâ€™t wait to make the next event even bigger and better!
As part of our first-ever CTF competition, I had the privilege of designing some of the challenges and here are the corresponding writeups.


### [ten*2] Challenge:

image: /assets/image/Posts/tenten.png
![alt text](image.png)
---
### Step 1: Unlock the AD1 file

The challenge starts with a password-protected AD1 (AccessData Custom Content Image) file. AD1 files, or AccessData Custom Content Images, are forensic image files created using tools like FTK Imager. These files are commonly used in digital forensics to store a snapshot of a device, folder, or file structure for analysis.

The challenge name was to hint and point you to the password you need to unlock the file in FTK Imager i.e [ten*2] = "tenten". Using "tenten" as the password, the AD1 file can be successfully unlocked in FTK Imager.


### Step 2: Inspecting the AD1 File

image: /assests/img/Posts/ftk.png
![alt text](image-1.png)

Upon opening the AD1 file in FTK Imager, we discover a text file containing a Base58-encoded string. Decoding this string (using tools like CyberChef, an online Base58 decoder, or a script) reveals XML content that looks like this:

```
<?xml version="1.0" encoding="utf-8" standalone="no"?>
<!DOCTYPE users SYSTEM>
<users max="82">
    <user>
        <loginname>p3rf3ctr00tctf</loginname>
        <password>$6$8FLxcJkWoi9kU6Zw$k4a5ExeU0OAeiSOOzBU9HLf.qChCKPbvvTw07pnzL8tJR8tjNfzlqG7fHUQ91qG5IVs3Nr4rEGlU7LkQcsvah.</password>
        <4cr_encrypt>50 e7 02 4c da 24 1d 0c 44 87 d5 1b 43 fa 47 2c fe 2e 28 fc 68 75 87 04 02 b6 0f e4 7e 74 f3 2c 27 cd 93 06 0f 9e f5 5c e5 03 0b 2d 0d 34 3e 6c 2a b0 58 a1 51 88 77 68 45 3a 7c c8 dd 2c 43 f9 f0 e0 68 60 97 4a b1 16 5e 6a 6c c1 bf d3 1a 00 bf 54 c4 85 d5 d1 a0 3a df 1c 1d 89 5b fe f0 3c 43 55 b5 99 8e 79 7b 39 ec ab 7b 74 91 9b 3e 20 d2 00 1e 74 71 d0 </4cr_encrypt>
    </user>
</users>
<!-- p3rf3ctr00t CTF 2024 -->
```


### Step 3: Analyzing the XML

1. Password Hash: $6$8FLxcJkWoi9kU6Zw$k4a5ExeU0OAeiSOOzBU9HLf.qChCKPbvvTw07pnzL8tJR8tjNfzlqG7fHUQ91qG5IVs3Nr4rEGlU7LkQcsvah.
2. Encrypted RC4 Data: `<4cr_encrypt>...</4cr_encrypt>` - played around with the name a bit

We crack the password hash using `hashcat` or `John the Ripper`. For example, with hashcat:
```
hashcat -a 0 -m 1800 hash.txt /usr/share/wordlists/rockyou.txt --force --status
```
1. `-a 0 (Attack Mode)`

Specifies the attack mode. -a 0 means "straight mode," where the tool directly compares hashes generated from the wordlist to the target hash without applying additional rules or modifications.
2. `-m 1800 (Hash Mode)`

Indicates the hash type to crack. 1800 corresponds to SHA-512 crypt (Unix). This ensures Hashcat interprets the input hash correctly.
3. `--force`

Forces Hashcat to run, bypassing warnings about hardware or configurations. (Note: This should be used with caution, as it may lead to instability or performance issues.)
4. `--status`

Continuously displays the current status of the cracking process, showing progress, estimated time, and other details.
The cracked password: `naruto`

### Step 4: Decoding the RC4 Encrypted Data

Using the cracked password (`naruto`) as the passphrase, we decode the RC4 encrypted data. This can be done using tools like CyberChef or Python scripts.

image: /assets/img/Posts/flag.png
![alt text](image-2.png)
The decrypted data reveals the flag.

Until next time nerds!

![out](https://github.com/k4p3re/k4p3re.github.io/assets/49836387/75122a67-9097-477f-b027-53710d8c1344)
